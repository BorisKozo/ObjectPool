!function(exports){var tempItem,tempCounter,tempType,tempValue,objectTypes={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},isArray=Array.isArray||function(obj){return"[object Array]"==toString.call(obj)},isFunction=function(obj){return"[object Function]"==toString.call(obj)},isObject=function(value){return tempType=typeof value,!(!value||!objectTypes[tempType])},shallowClone=function(obj){if(!isObject(obj))return obj;if(isArray(obj))return obj.slice();var result={};for(tempValue in obj)result[tempValue]=obj[tempValue];return result};exports.$Pool=function(){this._items=[],this._head=0},exports.$Pool.prototype.get=function(){return 0===this._head?null:(this._head--,this._items[this._head])},exports.$Pool.prototype.release=function(item){this._items[this._head]=item,this._head++},exports.$Pool.prototype.delete=function(count){this._head=Math.max(0,this._head-count),this._items.length=this._head},exports.$Pool.prototype.count=function(){return this._head},exports.$Generator=function(target,options){if(this.options=options||{},isFunction(target)&&!this.options.functionObject?this.itemConstructor=target:(this.item=target,this.clone=this.options.clone||shallowClone),this.pool=new exports.$Pool,this.options.data){for(tempValue in this.options.data)this.pool.release(tempValue);this.options.data=null}this.options.count&&this.create(this.options.count-this.pool.count())},exports.$Generator.prototype.tryRegenerate=function(){tempValue=isFunction(this.options.regenerate)?this.options.regenerate.apply(this):this.options.regenerate.valueOf(),this.create(tempValue)},exports.$Generator.prototype.get=function(){return tempItem=this.pool.get(),null===tempItem&&(this.options.regenerate&&(this.tryRegenerate(),tempItem=this.pool.get()),null===tempItem)?null:(this.options.init&&this.options.init.apply(tempItem,arguments),tempItem)},exports.$Generator.prototype.release=function(item){this.options.clear&&this.options.clear.apply(item),this.pool.release(item)},exports.$Generator.prototype.delete=function(size){tempCounter=size,1>size&&(tempCounter=this.pool.count()*size),tempCounter=Math.floor(tempCounter),this.pool.delete(tempCounter)},exports.$Generator.prototype.create=function(size){for(tempCounter=size;tempCounter>0;)this.itemConstructor?this.pool.release(new this.itemConstructor):this.pool.release(this.clone(this.item)),tempCounter--},exports.$Generator.prototype.count=function(){return this.pool.count()},exports.generate=function(target,options){return new exports.$Generator(target,options)},exports.array=exports.generate(function(){return[]},{clear:function(){this.length=0},count:60})}("undefined"==typeof exports?this.ObjectPool={}:exports);